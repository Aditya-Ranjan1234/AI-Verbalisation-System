<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Trip Verbalization System</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <!-- Leaflet Routing Machine -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.css" />
    <script src="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.js"></script>
    <style>
        #map {
            height: 300px;
            width: 100%;
            margin-bottom: 20px;
            border-radius: 8px;
            z-index: 1;
        }
        #navMap {
            height: 400px;
            width: 100%;
            margin-top: 15px;
            border-radius: 8px;
            z-index: 1;
        }
    </style>
</head>

<body>
    <!-- Navigation -->
    <nav class="navbar" id="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                    <circle cx="12" cy="10" r="3"></circle>
                </svg>
                <span>Trip Verbalization</span>
            </div>
            <div class="nav-links" id="navLinks">
                <a href="#home" class="nav-link active">Home</a>
                <a href="#trips" class="nav-link">Trips</a>
                <a href="#zones" class="nav-link">Zones</a>
                <a href="/docs" class="nav-link" target="_blank">API Docs</a>
            </div>
            <div class="nav-user" id="navUser" style="display: none;">
                <span class="user-name" id="userName"></span>
                <button class="btn btn-outline" id="logoutBtn">Logout</button>
            </div>
            <div class="nav-auth" id="navAuth">
                <button class="btn btn-outline" id="showLoginBtn">Login</button>
                <button class="btn btn-primary" id="showRegisterBtn">Register</button>
            </div>
        </div>
    </nav>

    <!-- Home Section -->
    <section id="home" class="hero">
        <div class="container">
            <div class="hero-content">
                <h1 class="hero-title">Transform GPS Data into Stories</h1>
                <p class="hero-subtitle">AI-powered trip data verbalization with geospatial validation and intelligent
                    analytics</p>
                <div class="hero-stats">
                    <div class="stat-card">
                        <div class="stat-number" id="totalTrips">0</div>
                        <div class="stat-label">Total Trips</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalZones">0</div>
                        <div class="stat-label">Zones Created</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">BCNF</div>
                        <div class="stat-label">Database Schema</div>
                    </div>
                </div>
                <div class="hero-actions">
                    <button class="btn btn-large btn-primary" id="getStartedBtn">Get Started</button>
                    <a href="/docs" target="_blank" class="btn btn-large btn-outline">View API</a>
                </div>
            </div>
        </div>
    </section>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Login to Your Account</h2>
                <button class="modal-close" data-modal="loginModal">&times;</button>
            </div>
            <form id="loginForm" class="form">
                <div class="form-group">
                    <label for="loginUsername">Username</label>
                    <input type="text" id="loginUsername" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" class="form-control" required>
                </div>
                <div class="form-error" id="loginError"></div>
                <button type="submit" class="btn btn-primary btn-block">Login</button>
                <p class="form-footer">
                    Don't have an account? <a href="#" id="switchToRegister">Register here</a>
                </p>
            </form>
        </div>
    </div>

    <!-- Register Modal -->
    <div class="modal" id="registerModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Create New Account</h2>
                <button class="modal-close" data-modal="registerModal">&times;</button>
            </div>
            <form id="registerForm" class="form">
                <div class="form-group">
                    <label for="regUsername">Username</label>
                    <input type="text" id="regUsername" class="form-control" minlength="3" required>
                </div>
                <div class="form-group">
                    <label for="regEmail">Email</label>
                    <input type="email" id="regEmail" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="regPassword">Password</label>
                    <input type="password" id="regPassword" class="form-control" minlength="8" required>
                </div>
                <div class="form-group">
                    <label for="regRole">Role</label>
                    <select id="regRole" class="form-control">
                        <option value="user">User</option>
                        <option value="analyst">Analyst</option>
                    </select>
                </div>
                <div class="form-error" id="registerError"></div>
                <button type="submit" class="btn btn-primary btn-block">Create Account</button>
                <p class="form-footer">
                    Already have an account? <a href="#" id="switchToLogin">Login here</a>
                </p>
            </form>
        </div>
    </div>

    <!-- Trips Section -->
    <section id="trips" class="section" style="display: none;">
        <div class="container">
            <div class="section-header">
                <h2>Trip Management</h2>
                <button class="btn btn-primary" id="createTripBtn">+ Create Trip</button>
            </div>

            <div class="trips-grid" id="tripsGrid">
                <div class="empty-state">
                    <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="1.5">
                        <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                        <circle cx="12" cy="10" r="3"></circle>
                    </svg>
                    <p>No trips yet. Create your first trip!</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Create Trip Modal -->
    <div class="modal" id="createTripModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>Create New Trip</h2>
                <button class="modal-close" data-modal="createTripModal">&times;</button>
            </div>
            <form id="createTripForm" class="form">
                <div id="map"></div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Map Selection Mode</label>
                        <div class="radio-group">
                            <label><input type="radio" name="mapMode" value="start" checked> Set Start</label>
                            <label><input type="radio" name="mapMode" value="end"> Set End</label>
                        </div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="startLat">Start Latitude</label>
                        <input type="number" id="startLat" class="form-control" step="0.0001" min="-90" max="90"
                            required>
                        <small>Range: -90 to 90</small>
                    </div>
                    <div class="form-group">
                        <label for="startLon">Start Longitude</label>
                        <input type="number" id="startLon" class="form-control" step="0.0001" min="-180" max="180"
                            required>
                        <small>Range: -180 to 180</small>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="endLat">End Latitude</label>
                        <input type="number" id="endLat" class="form-control" step="0.0001" min="-90" max="90" required>
                    </div>
                    <div class="form-group">
                        <label for="endLon">End Longitude</label>
                        <input type="number" id="endLon" class="form-control" step="0.0001" min="-180" max="180"
                            required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="startTime">Start Time</label>
                        <input type="datetime-local" id="startTime" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="endTime">End Time</label>
                        <input type="datetime-local" id="endTime" class="form-control" required>
                    </div>
                </div>
                <div class="form-error" id="createTripError"></div>
                <button type="submit" class="btn btn-primary btn-block">Create Trip</button>
            </form>
        </div>
    </div>

    <!-- Zones Section -->
    <section id="zones" class="section" style="display: none;">
        <div class="container">
            <div class="section-header">
                <h2>Zone Configuration</h2>
                <button class="btn btn-primary" id="createZoneBtn">+ Create Zone</button>
            </div>
            <div class="zones-grid" id="zonesGrid">
                <div class="empty-state">
                    <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="1.5">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="9" y1="9" x2="15" y2="15"></line>
                        <line x1="15" y1="9" x2="9" y2="15"></line>
                    </svg>
                    <p>No zones configured. Create your first zone!</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Create Zone Modal -->
    <div class="modal" id="createZoneModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Create New Zone</h2>
                <button class="modal-close" data-modal="createZoneModal">&times;</button>
            </div>
            <form id="createZoneForm" class="form">
                <div class="form-group">
                    <label for="zoneName">Zone Name</label>
                    <input type="text" id="zoneName" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="zoneDescription">Description (Optional)</label>
                    <textarea id="zoneDescription" class="form-control" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>Boundary Coordinates (Polygon)</label>
                    <p class="form-hint">Enter coordinates as [longitude, latitude] pairs. Example: [[77.5, 12.9],
                        [77.6, 12.9], [77.6, 13.0], [77.5, 13.0]]</p>
                    <textarea id="zoneBoundary" class="form-control" rows="5"
                        placeholder='[[77.5, 12.9], [77.6, 12.9], [77.6, 13.0], [77.5, 13.0]]' required></textarea>
                </div>
                <div class="form-error" id="createZoneError"></div>
                <button type="submit" class="btn btn-primary btn-block">Create Zone</button>
            </form>
        </div>
    </div>

    <!-- Story Modal -->
    <div class="modal" id="storyModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Trip Story</h2>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <button id="speakStoryBtn" class="btn btn-outline" style="padding: 5px 10px;">
                        üîä Speak
                    </button>
                    <button class="modal-close" data-modal="storyModal">&times;</button>
                </div>
            </div>
            <div class="story-content" style="padding: 2rem;">
                <div id="storyLoader" style="text-align: center; display: none;">
                    <svg width="40" height="40" viewBox="0 0 24 24" fill="none" class="spin" stroke="currentColor"
                        stroke-width="2">
                        <path
                            d="M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83">
                        </path>
                    </svg>
                    <p style="margin-top: 1rem; color: var(--gray);">Verbalizing trip data with AI...</p>
                </div>
                <div id="storyText" style="line-height: 1.8; color: var(--dark);"></div>
                <div id="storyLocations"
                    style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid #e5e7eb; font-size: 0.9em; color: var(--gray);">
                </div>
                
                <!-- Live Navigation Section -->
                <div class="navigation-section" style="margin-top: 2rem; padding-top: 1rem; border-top: 2px solid #f0f0f0;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <h3>üìç Live Navigation</h3>
                        <button id="startNavBtn" class="btn btn-primary">Start Navigation</button>
                    </div>
                    <div id="navContainer" style="display: none;">
                        <p id="navStatus" style="color: var(--primary); font-weight: 500; margin-bottom: 0.5rem;">Locating you...</p>
                        <div id="navMap"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <script src="/js/app.js"></script>
</body>

</html>